{% extends 'admin/base.html.twig' %}
{% block title %}Productos{% endblock %}

{% block body %}
<h1 class="mb-4">Productos</h1>

<a href="{{ path('admin_productos_nuevo') }}" class="btn btn-primary mb-3">Nuevo Producto</a>

<div class="table-responsive">
<table class="table table-hover shadow-sm rounded align-middle">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Precio</th>
            <th>Stock total</th>
            <th>Variaciones</th>
        </tr>
    </thead>
    <tbody>
        {% for producto in productos %}
            {% set totalStock = 0 %}
            {% for v in producto.variaciones %}
                {% set totalStock = totalStock + v.stock %}
            {% endfor %}

            <tr>
                <td>{{ producto.id }}</td>
                <td class="text-start">
                    <strong>{{ producto.nombre }}</strong>
                </td>
                <td>{{ producto.precio }}â‚¬</td>

                <td>
                    <span class="badge bg-info text-dark">
                        {{ totalStock }} uds
                    </span>
                </td>

                <td>
                    <a href="{{ path('admin_productos_variaciones', {'id': producto.id}) }}"
                       class="btn btn-sm btn-outline-secondary">
                        Ver variaciones ({{ producto.variaciones|length }})
                    </a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endblock %}

{% block styles %}
<style>
.table {
    background-color: #fff;
    border-radius: 8px;
    overflow: hidden;
}
.table thead th {
    text-align: center;
    font-weight: 600;
}
.table tbody td {
    text-align: center;
}
.table tbody td.text-start {
    text-align: left;
}
.table-hover tbody tr:hover {
    background-color: #f8f9fa;
    transition: 0.3s;
}
.btn-sm {
    border-radius: 5px;
    font-weight: 500;
}
.badge {
    font-size: 0.85em;
    padding: 0.35em 0.6em;
}
</style>
{% endblock %}
